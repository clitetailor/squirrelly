!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).Sqrl={})}(this,function(e){"use strict";var r={},F=/{{ *?(?:(?:(?:(?:([\w$]+ *?(?:[^\s\w($][^\n]*?)*?))|(?:@(?:([\w$]+:|(?:\.\.\/)+))? *(.+?) *))(?: *?(\| *?[\w$]+? *?)+?)?)|(?:([\w$]+) *?\(([^\n]*?)\) *?([\w$]*))|(?:\/ *?([\w$]+))|(?:# *?([\w$]+))|(?:([\w$]+) *?\(([^\n]*?)\) *?\/)|(?:!--[^]+?--)) *?}}\n?/g,P={s:"{{",e:"}}"},n=/"(?:[^"\\]|\\.)*"|'(?:[^'\\]|\\.)*'|[\\]@(?:[\w$]*:)?[\w$]+|@(?:([\w$]*):)?([\w$]+)/g,k=F,q=P;function t(e,n){var r=e+k.source.slice(q.s.length,0-(q.e.length+3))+n+"\\n?",t=k.lastIndex;q={s:e,e:n},(k=RegExp(r,"g")).lastIndex=t}function H(e){return e=e.replace(n,function(e,n,r){return void 0===r?e:(void 0===n&&(n=""),"hvals"+n+"."+r)})}var O={if:{helperStart:function(e){return"if("+e+"){"},helperEnd:function(){return"}"},blocks:{else:function(){return"}else{"}}},each:{helperStart:function(e,n){return"for(var i=0;i<"+e+".length; i++){tR+=(function(hvals){var tR='';var hvals"+n+"=hvals;"},helperEnd:function(e){return"return tR})({this:"+e+"[i],index:i})};"}},foreach:{helperStart:function(e,n){return"for(var key in "+e+"){if(!"+e+".hasOwnProperty(key)) continue;tR+=(function(hvals){var tR='';var hvals"+n+"=hvals;"},helperEnd:function(e){return"return tR})({this:"+e+"[key], key: key})};"}},log:{selfClosing:function(e){return"console.log("+e+");"}},tags:{selfClosing:function(e){return t(e.slice(0,e.indexOf(",")).trim(),e.slice(e.indexOf(",")+1).trim()),""}},js:{selfClosing:function(e){return e+";"}}},i={"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#39;"};function l(e){return i[e]}var a=/[&<"']/g,o=/[&<"']/,s={e:function(e){var n=String(e);return o.test(n)?n.replace(a,l):n}},f={},c={start:"",end:""};var u=!0;function b(e,n){var r;console.log(n);var t=!1,i=c.start,l=c.end;if(n&&""!==n){r=n.split("|"),console.log(r);for(var a=0;a<r.length;a++){console.log(a);var o=r[a].trim();console.log("filter: "+o),""!==o&&("safe"!==o?(i="Sqrl.F."+o+"("+i,l+=")"):(console.log("safe"),t=!0))}}return!t&&u&&(i+="Sqrl.F.e(",l+=")"),i+e+l}var E={};function v(e){var n,r,t,i,l,a,o=0,s="",f=[],c=-1,u=0,v={};for(q=P,(k=F).lastIndex=0;null!==(n=k.exec(e));)if(""===s?s+="var tR='"+e.slice(o,n.index).replace(/'/g,"\\'")+"';":o!==n.index&&(s+="tR+='"+e.slice(o,n.index).replace(/'/g,"\\'")+"';"),o=n[0].length+n.index,n[1])s+="tR+="+(l=n[1],a=n[4],b("options."+l,a))+";";else if(n[3])s+="tR+="+(r=n[3],t=n[2],i=n[4],b(void 0!==t?"hvals"+(/(?:\.\.\/)+/g.test(t)?f[c-t.length/3-1].id:t.slice(0,-1))+"."+r:"hvals."+r,i))+";";else if(n[5]){var d=n[7];""!==d&&null!==d||(d=u,u++);var h=O.hasOwnProperty(n[5]);c+=1;var p=n[6]||"";p=H(p),h||(p="["+p+"]");var g={name:n[5],id:d,params:p,native:h};f[c]=g,h?(s+=O[n[5]].helperStart(p,d),o=k.lastIndex):s+="tR+=Sqrl.H."+n[5]+"("+p+",function(hvals){var hvals"+d+"=hvals;var tR='';"}else if(n[8]){var R=f[c];R&&R.name===n[8]?(c-=1,!0===R.native?s+=O[R.name].helperEnd(R.params,R.id):v[R.id]?s+="return tR}});":s+="return tR});"):console.error("Helper beginning & end don't match.")}else if(n[9]){var x=f[c];if(x.native){var w=O[x.name];w.blocks&&w.blocks[n[9]]?(s+=w.blocks[n[9]](x.id),o=k.lastIndex):console.warn("Native helper '%s' doesn't accept that block.",x.name)}else v[x.id]?s+="return tR},"+n[9]+":function(hvals){var hvals"+x.id+"=hvals;var tR='';":(s+="return tR},{"+n[9]+":function(hvals){var hvals"+x.id+"=hvals;var tR='';",v[x.id]=!0)}else if(n[10]){var y=n[11]||"";if(y=H(y),"include"===n[10]){var $=e.slice(0,n.index),m=e.slice(n.index+n[0].length),S=y.replace(/'|"/g,"");e=$+E[S]+m,o=k.lastIndex=n.index}else O.hasOwnProperty(n[10])&&O[n[10]].hasOwnProperty("selfClosing")?(s+=O[n[10]].selfClosing(y),o=k.lastIndex):s+="tR+=Sqrl.H."+n[10]+"("+y+");"}return""===s?s+="var tR='"+e.slice(o,e.length).replace(/'/g,"\\'")+"';":o!==e.length&&(s+="tR+='"+e.slice(o,e.length).replace(/'/g,"\\'")+"';"),s+="return tR",new Function("options","Sqrl",s.replace(/\n/g,"\\n").replace(/\r/g,"\\r"))}var d={};function h(e,n){var r=e.$file,t=e.$name,i=e.$cache;if(!1===i)return v(n);if(r){if(d[r])return d[r];var l=require("fs").readFileSync(r,"utf8");return d[r]=v(l),d[r]}return t?d[t]?d[t]:n?(d[t]=v(n),d[t]):void 0:n?!0===i?(d[n]||(d[n]=v(n)),d[n]):v(n):"Error"}function p(e,n){return n.$file=e,h(n)(n,{H:r,F:s,P:E})}e.H=r,e.Compile=v,e.defineFilter=function(e,n){s[e]=n},e.defineHelper=function(e,n){r[e]=n},e.defineNativeHelper=function(e,n){O[e]=n},e.definePartial=function(e,n){E[e]=n},e.Render=function(e,n){return"function"==typeof e?e(n,{H:r,F:s,P:E}):"string"==typeof e?h(n,e)(n,{H:r,F:s,P:E}):void 0},e.renderFile=p,e.load=h,e.__express=function(e,n,r){return r(null,p(e,n))},e.F=s,e.setDefaultFilters=function(e){if("clear"===e)f={};else for(var n in e)e.hasOwnProperty(n)&&(f[n]=e[n]);!function(){for(var e in c={start:"",end:""},f)f.hasOwnProperty(e)&&f[e]&&(c.start+="Sqrl.F."+e+"(",c.end+=")")}()},e.autoEscaping=function(e){return u=e},e.defaultTags=function(e){t(e[0],e[1]),F=k,P=q},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=squirrelly.min.js.map
